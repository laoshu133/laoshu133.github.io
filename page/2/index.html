<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="米空格" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="米空格">
<meta property="og:url" content="http://www.laoshu133.com/page/2/index.html">
<meta property="og:site_name" content="米空格">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="米空格">
<meta name="twitter:description">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="http://www.laoshu133.com/page/2/"/>

  <title> 米空格 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  








  <div style="display: none;">
    <script src="http://s6.cnzz.com/stat.php?id=4571571&web_id=4571571" type="text/javascript"></script>
  </div>





  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">米空格</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2013/02/27/Chrome更改parseInt默认转换规则.html" itemprop="url">
                  Chrome更改parseInt默认转换规则
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2013-02-27T23:33:20+08:00" content="2013-02-27">
              2013-02-27
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2013/02/27/Chrome更改parseInt默认转换规则.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2013/02/27/Chrome更改parseInt默认转换规则.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天看到Chrome有更新，就升级了，目前最新稳定版本<strong>Chrome 25.0.1364.97 m</strong>，然后很高兴的发现之前的<a href="/post/crash_chrome.html">崩溃BUG</a>居然已经修复了。</p>
<p>不过很显然新的问题又出来了，不然就不会有这么一篇文章了，下午在弄一个公司培训的PPT，里面需要写到<code>parseInt</code>的一个经典陷阱。</p>
<p>首先回顾一下<code>parseInt(string, radix)</code>当省略<code>radix</code>参数时，大致的解析过程：</p>
<ul>
<li><p>当<code>string</code>以0开头，且后面紧跟x时，按照<code>parseInt(string, 16)</code>处理</p>
</li>
<li><p>当<code>string</code>以0开头，且后面紧跟非x时，按照<code>parseInt(string, 8)</code>处理</p>
</li>
<li><p>其余统一按照<code>parseInt(string, 10)</code>处理</p>
</li>
</ul>
<p>当然强烈建议始终使用<code>radix</code>参数</p>
<p>&nbsp;</p>
<p>按照上面的解析规则，<code>parseInt(&#39;010&#39;)</code>很自然应该返回<code>8</code> ，不过奇怪的是Chorme返回的居然是<code>10</code>，难道最新版Chrome改掉了以前默认的转换规则？</p>
<p>晚上回家又拿Chrome 24.0.1312.56试了一下，发现结果也是一样的（没有更早的版本了），看来Chrome改掉这个规则已经不是一两天了，不知其他浏览器会不会效仿。。。</p>
<p>最后趁着这赶脚，再稍微回顾一下<code>parseInt</code>和<code>parseFloat</code>转换数字上的区别：</p>
<ul>
<li><p><code>parseFloat</code>只能转换10进制，而<code>parseInt</code>则支持第二个参数<code>parseInt(string[, radix])</code>，理论上支持任意进制的数字</p>
</li>
<li><p><code>parseInt</code>不能转换科学计数<code>parseInt(&#39;1e2&#39;);//1</code>，<code>parseFloat(&#39;1e2&#39;);//100</code></p>
</li>
<li><p><code>parseInt</code>无法转换省略小数点前面0的数字<code>parseInt(&#39;.1&#39;);//NaN</code>，<code>parseFloat(&#39;.1&#39;);//0.1</code></p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/10/23/7行崩掉-Crash-Chrome.html" itemprop="url">
                  7行崩掉(Crash)Chrome
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-10-23T21:08:29+08:00" content="2012-10-23">
              2012-10-23
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/10/23/7行崩掉-Crash-Chrome.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/10/23/7行崩掉-Crash-Chrome.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>升级到<strong>Chrome 25.0.1364.97 m</strong>，此BUG已经修复</p>
<p>昨天在写页面时，无意间写了一个<code>ul&gt;li&gt;input:file</code>的结构，然后<code>li</code>左浮动（实际后面发现左/右浮动是一样的）<code>li{float:left;}</code>，<code>li</code>的上级有一个很经典的<code>.clearfix</code>，在然后发现Chrome居然崩溃了，崩溃了。。。</p>
<p>然后今天特意花了点时间来重现我们万能的Chrome的BUG（别的平台均未重现，包括Safari），最后发现通过如下7行代码，可以轻松重现：</p>
<ul>
<li>测试环境：WIN7/XP/MAC 20.0.1132.57 m/22.0.1229.94 m</li>
<li>重现条件：CSS部分缺一不可，HTML结构随意，input一定要是file</li>
<li>具体原因未知</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"></span><br><span class="line"><span class="selector-class">.clearfix</span><span class="selector-pseudo">:after</span>&#123; <span class="attribute">content</span>:<span class="string">""</span>; <span class="attribute">display</span>:block;&#125;</span><br><span class="line"><span class="selector-class">.clearfix</span> <span class="selector-tag">li</span>&#123; <span class="attribute">float</span>:left;&#125;</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">*   <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>废话不多，给出<a href="/Lab/crash_chrome/">DEMO地址</a>，欢迎拍砖。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/08/08/CSS-背景居中次像素无法重合.html" itemprop="url">
                  CSS 背景居中次像素无法重合
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-08-08T12:26:03+08:00" content="2012-08-08">
              2012-08-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/08/08/CSS-背景居中次像素无法重合.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/08/08/CSS-背景居中次像素无法重合.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>又见CSS BUG，昨天赶工写完一个页面，专题页面，又需要重用，没花太多时间处理细节上的东西，因为大部分模块都可以直接替换；今天早上同事和我说：“Safari 下面背景是不是有1px偏移？”，听完觉得挺奇怪，一般不应该存在这样的问题的，然后一看就有了这篇文章</p>
<p>首先重现BUG(此Demo仅CSS3支持，Chrome/Safari最佳)：</p>
<p><style type="text/css">.t_shell{ border:1px solid #ddd; margin-bottom:15px; padding:20px 0 0; width:500px; position:relative;}.t_wrap{ background:#eee; margin:0 auto 20px; width:401px;}.t_wrap:before{ content:’.t_wrap’; position:absolute;}.t_panel{ background: #299a0b;background: -moz-linear-gradient(top, #299a0b 0%, #299a0b 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#299a0b), color-stop(100%,#299a0b));background: -webkit-linear-gradient(top, #299a0b 0%,#299a0b 100%);background: -o-linear-gradient(top,  #299a0b 0%,#299a0b 100%);background: -ms-linear-gradient(top,  #299a0b 0%,#299a0b 100%);background: linear-gradient(to bottom,  #299a0b 0%,#299a0b 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=’#299a0b’, endColorstr=’#299a0b’,GradientType=0 );}.t_inner{ background: #cf0404;background: -moz-linear-gradient(top, #cf0404 43%, #ff3019 100%);background: -webkit-gradient(linear, left top, left bottom, color-stop(43%,#cf0404), color-stop(100%,#ff3019));background: -webkit-linear-gradient(top,  #cf0404 43%,#ff3019 100%);background: -o-linear-gradient(top,  #cf0404 43%,#ff3019 100%);background: -ms-linear-gradient(top,  #cf0404 43%,#ff3019 100%);background: linear-gradient(to bottom,  #cf0404 43%,#ff3019 100%);filter: progid:DXImageTransform.Microsoft.gradient( startColorstr=’#cf0404’, endColorstr=’#ff3019’,GradientType=0 );}.t_panel{ background-repeat:no-repeat; background-size:200px 120px; background-position:50% 20px; padding:140px 0 0 0; height:140px;}/<em>.t_panel:before{ content:’.t_panel’; position:absolute; width:100%;}</em>/.t_inner{ background-repeat:no-repeat; margin:0 auto; height:120px; width:200px;}.t_inner:before{ color:#fff; content:’.t_inner’; position:absolute;}.t_btns{ border-top:1px solid #ddd; padding:10px 20px;}.t_btns button{ padding:5px;}</style></p>
<p><div class="t_shell">    <div class="t_wrap">        <div class="t_panel">            <div class="t_inner" title=".t_inner"></div>        </div>    </div>    <div class="t_btns"><button onclick="var el=$('.t_wrap'); el.width(el.width()+3);">.t_wrap width +3px</button><button onclick="var el=$('.t_wrap'); el.width(el.width()-3);">.t_wrap width -3px</button></div></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"t_shell"</span>&gt;</span>	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"t_wrap"</span>&gt;</span>		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"t_panel"</span>&gt;</span>			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"t_inner"</span> <span class="attr">title</span>=<span class="string">".t_inner"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>		<span class="tag">&lt;/<span class="name">div</span>&gt;</span>	<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.t_wrap</span>&#123; <span class="attribute">background</span>:<span class="number">#eee</span>; <span class="attribute">margin</span>:<span class="number">0</span> auto; <span class="attribute">width</span>:<span class="number">401px</span>;&#125;</span><br><span class="line"><span class="selector-class">.t_panel</span>&#123; <span class="attribute">background</span>:<span class="built_in">-webkit-linear-gradient</span>(top, #299a0b 0%,#299a0b 100%) no-repeat; <span class="attribute">background-position</span>:<span class="number">50%</span> <span class="number">20px</span>; <span class="attribute">padding</span>:<span class="number">140px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>; <span class="attribute">height</span>:<span class="number">140px</span>;&#125;</span><br><span class="line"><span class="selector-class">.t_inner</span>&#123; <span class="attribute">background</span>:<span class="built_in">-webkit-linear-gradient</span>(top, #cf0404 43%,#ff3019 100%); <span class="attribute">margin</span>:<span class="number">0</span> auto; <span class="attribute">height</span>:<span class="number">120px</span>; <span class="attribute">width</span>:<span class="number">200px</span>;&#125;</span><br></pre></td></tr></table></figure>
<p>点击“.t_wrap width +3px”按钮增加(div.t_wrap)宽度时候，能够很明显的看到绿色块(div.t_panel)有1px左右的来回摆动。</p>
<p>出现以上BUG的原因，国外“ACKO”给出的原因如下：</p>
<ul>
<li><p>The width of the viewport</p>
</li>
<li><p>The odd/even size of the box/element</p>
</li>
<li><p>Background image is bigger/smaller than the viewport</p>
</li>
<li><p>Background image is padded evenly/unevenly around the box (1px difference). (<em>)&gt; (</em>) Note that there is a choice whether to pad more on the left or on the right. I chose the left. This means that the last 4 rows of test cases are inherently ambiguous: a browser that misaligns all of these in the same fashion is in fact being consistent, just in the opposite direction.</p>
</li>
</ul>
<p>原文地址：<a href="http://acko.net/blog/css-sub-pixel-background-misalignments/" target="_blank" rel="external">Sub-pixel-background-misalignments</a></p>
<p>解决方案：</p>
<p>在我测试过程中，发现基本上只要上面给出原因前面两条不出现，<strong>即：宽度不跟随视图变化，容器的宽度适中为偶数或者奇数；就可以有效避免</strong></p>
<p>另外，在查找资料的过程中，发现另外一个解决方案，不过我根据我测试的好像不是很给力，当视图宽度变化时，依然能重现：<br><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">media</span> screen and (-webkit-min-device-pixel-ratio:<span class="number">0</span>)&#123;</span><br><span class="line">	<span class="selector-class">.t_panel</span>&#123; <span class="attribute">background-position</span>:<span class="number">50.001%</span> <span class="number">20px</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>原文地址：<a href="http://philfreo.com/blog/fixing-safaris-1px-background-image-centering-problem/" target="_blank" rel="external">Fixing-Safari-1px-background-image-centering-problem</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/08/03/JPG渐进-amp-PNG-PNG24-交错测试.html" itemprop="url">
                  JPG渐进 &amp; PNG/PNG24 交错测试
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-08-03T16:20:35+08:00" content="2012-08-03">
              2012-08-03
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/08/03/JPG渐进-amp-PNG-PNG24-交错测试.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/08/03/JPG渐进-amp-PNG-PNG24-交错测试.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天由同事说起，PS导出PNG时，有个选项”交错“是干啥的，想起这也是个问题，所以特意搞了个测试页面：</p>
<p>引用网上”交错-就是类似旧式电视的隔行扫描，让图片只花50%的时间就可以看到图片全貌“，<br>另外JPG的”渐进“也有类似效果，可惜支持的浏览器不多</p>
<p>在测试各个浏览器（未说明都为最新版本）时发现：</p>
<ol>
<li><p>Chrome对“渐进”和“交错”都支持良好</p>
</li>
<li><p>Safari(PC/MAC)对“渐进”不支持，“交错支持良好”</p>
</li>
<li><p>Fiefox对“渐进”和“交错”都支持良好</p>
</li>
<li><p>Opera对“渐进”和“交错”都支持良好</p>
</li>
<li><p>IE9对“渐进”和“交错”都不支持</p>
</li>
</ol>
<p>测试地址：<a href="http://www.laoshu133.cn/Interlace_test/" target="_blank" rel="external">Interlace_test</a></p>
<p>从测试的加载情况可以很容易看出，在对于需要加载大图片的情况下，在导出图片时选择“交错”（PS里JPG选择“连续”），对于用户体验上有很大的改善</p>
<p>另外，在&lt;img /&gt;标签有个lowsrc属性，可以指定图片的缩略图，用于避免，页面打开时一片空白；不过现在这个属性出现的概率貌似有点低；</p>
<p>引用某处关于“渐进”(Interlace)和“交错”(Progressive)的解释：</p>
<blockquote>
<p>JPEG、GIF和PNG这三种图像格式都提供了一种功能，让图像能够更快地显示。图像可以以一种特殊方式存储，显示时先大概显示图像的草图，当文件全部下载后再填充细节。这起到一种很有意义的心理效果，因为这样使人们有东西可看，而不必坐着干等大型图像慢慢显示在屏幕上。</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/07/30/DatePicker-基于jQuery-的日期选择控件.html" itemprop="url">
                  DatePicker - 基于jQuery 的日期选择控件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-07-30T14:30:58+08:00" content="2012-07-30">
              2012-07-30
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/07/30/DatePicker-基于jQuery-的日期选择控件.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/07/30/DatePicker-基于jQuery-的日期选择控件.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前不久因为公司活动需求，需要一个简单的日期选择控件，而且时效性不是很短，所以不想去用JQuery UI那样笨重的日期选择插件，于是就有了今天这篇：</p>
<p>首先从需求角度出发，我们对日期要求不高，比如不要求一定要有明确的星期几，不要求有明确的用户输入日期；但是要求：</p>
<ol>
<li><p>体积够小，速度够快</p>
</li>
<li><p>高度可定制性，配置参数完善</p>
</li>
</ol>
<p>于是，我打算不用图片处理界面，采用CSS3降级处理，单文件，HTML模板和CSS采用动态注入的方式。</p>
<p>完整代码（16KB）：<a href="http://www.laoshu133.cn/Lab/DatePicker/jquery.DatePicker.js" target="_blank" rel="external">jquery.DatePicker.js(未压缩)</a>，完善的<a href="http://www.laoshu133.cn/Lab/DatePicker/#all_option" target="_blank" rel="external">配置参数</a></p>
<p>完整DEMO地址：<a href="http://www.laoshu133.cn/Lab/DatePicker/" target="_blank" rel="external">DatePicker</a></p>
<p>一个简单DEMO：</p>
<p><input type="text" id="date_picker_demo" value="2012-12-12"></p>
<p><script type="text/javascript">window.onload = function(){$.getScript(‘<a href="http://www.laoshu133.cn/Lab/DatePicker/jquery.DatePicker.js">http://www.laoshu133.cn/Lab/DatePicker/jquery.DatePicker.js</a>‘, function(){$(‘#date_picker_demo’).datePicker({followOffset : [0, 24]}).focus();});}</script><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$.getScript(<span class="string">'http://www.laoshu133.cn/Lab/DatePicker/jquery.DatePicker.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		$(<span class="string">'#date_picker_demo'</span>).datePicker(&#123;</span><br><span class="line">			followOffset : [<span class="number">0</span>, <span class="number">24</span>]</span><br><span class="line">		&#125;)</span><br><span class="line">		.focus();</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其实，说小那是相对于 JQuery UI那样的笨重的插件来说的，本来以为不用多少代码就可以搞定了，没想到写着写着就 16KB 了。</p>
<p>&nbsp;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/07/19/基于给定路径求相对路径.html" itemprop="url">
                  基于给定路径求相对路径
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-07-19T10:27:13+08:00" content="2012-07-19">
              2012-07-19
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/07/19/基于给定路径求相对路径.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/07/19/基于给定路径求相对路径.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>今天群里出了个题目，原题如下：</p>
<blockquote>
<pre>求一函数
原字符串为
var str = "aaa/bbb/ccc/"
如果用户输入
 '../dd.js'
那么返回
aaa/bbb/dd.js
如果用户输入
 '../../ee.js'
那么返回
aaa/ee.js
如果用户输入
 '../../../hh.js'
那么返回
hh.js
function adjustPath(str, user){

}</pre>

</blockquote>
<p>另外应群里童鞋处理特许情况，又需要处理一下情况</p>
<ol>
<li><p>URL中存在<code>./</code>，例如：<code>../..//xx.js</code></p>
</li>
<li><p>URL中存在<code>//</code>，例如：<code>./ii.js</code></p>
</li>
</ol>
<p>其实对于这题，很早以前就看到过，只是一直没去花时间，正好今天早上闲着，就写了个：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">absPath</span>(<span class="params">str, user</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> sCount = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">var</span> url = (user + <span class="string">''</span>).replace(<span class="regexp">/\.\.\//g</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		sCount++;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">''</span>;</span><br><span class="line">	&#125;)</span><br><span class="line">	.replace(<span class="regexp">/\.\//g</span>, <span class="string">''</span>);</span><br><span class="line"></span><br><span class="line">	str = (str + <span class="string">''</span>).replace(<span class="regexp">/\/+$/</span>, <span class="string">''</span>);</span><br><span class="line">	str = str.split(<span class="string">'/'</span>).slice(<span class="number">0</span>, sCount &gt; <span class="number">0</span> ? -sCount : <span class="keyword">void</span> <span class="number">0</span>).join(<span class="string">'/'</span>);</span><br><span class="line"></span><br><span class="line">	url = str.length &gt; <span class="number">0</span> ? str + <span class="string">'/'</span> + url : url;</span><br><span class="line">	<span class="keyword">return</span> url.replace(<span class="regexp">/\/\/+/g</span>, <span class="string">'/'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在以上代码发出去后，群里影响几乎为 0 的情况下，出去喝了杯水，想到应该得出点奇淫技巧了，于是就又有了：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MS 还是比较给力的</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">absPath</span>(<span class="params">str, user</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> a = <span class="built_in">document</span>.createElement(<span class="string">'a'</span>);</span><br><span class="line">	a.href = str + user;</span><br><span class="line">	<span class="comment">//console.info('getAttribute, href = ', a.getAttribute('href', 4));</span></span><br><span class="line">	<span class="keyword">var</span> urlPri = location.href.slice(<span class="number">0</span>, location.href.lastIndexOf(<span class="string">'/'</span>) + <span class="number">1</span>);</span><br><span class="line">	<span class="comment">//实际只有IE7- 需要 a.getAttribute('href', 4) 取得浏览器拼接好的URL</span></span><br><span class="line">	<span class="keyword">return</span> (!-[<span class="number">1</span>,] ? a.getAttribute(<span class="string">'href'</span>, <span class="number">4</span>) : a.href).replace(urlPri, <span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>测试代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.warn(<span class="string">'test 1 - '</span>, absPath(<span class="string">'aaa/bbb/ccc/'</span>, <span class="string">'../dd.js'</span>));</span><br><span class="line"><span class="built_in">console</span>.warn(<span class="string">'test 2 - '</span>, absPath(<span class="string">'aaa/bbb/ccc/'</span>, <span class="string">'../../ee.js'</span>));</span><br><span class="line"><span class="built_in">console</span>.warn(<span class="string">'test 3 - '</span>, absPath(<span class="string">'aaa/bbb/ccc/'</span>, <span class="string">'../../../hh.js'</span>));</span><br><span class="line"><span class="built_in">console</span>.warn(<span class="string">'test 4 - '</span>, absPath(<span class="string">'aaa/bbb/ccc/'</span>, <span class="string">'../..//xx.js'</span>));</span><br><span class="line"><span class="built_in">console</span>.warn(<span class="string">'test 5 - '</span>, absPath(<span class="string">'aaa/bbb/ccc/'</span>, <span class="string">'./ii.js'</span>));</span><br></pre></td></tr></table></figure></p>
<p>最后给出群里 “糖果男孩” 的一个比较给力函数，不过如果需要支持上面说的几个特许情况，还得改造一下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">adjustPath</span>(<span class="params">str, user</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> patharr = str.replace(<span class="regexp">/\/$/</span>,<span class="string">""</span>).split(<span class="string">"\/"</span>);</span><br><span class="line">	<span class="keyword">var</span> nstr = user.replace(<span class="regexp">/\.\.\//g</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		patharr.pop();</span><br><span class="line">		<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="keyword">return</span> patharr.join(<span class="string">"/"</span>)+<span class="string">"/"</span>+nstr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2012/02/27/ZBLOG主题-Ceedo-V2-0.html" itemprop="url">
                  ZBLOG主题[Ceedo] V2.0
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2012-02-27T04:11:00+08:00" content="2012-02-27">
              2012-02-27
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2012/02/27/ZBLOG主题-Ceedo-V2-0.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2012/02/27/ZBLOG主题-Ceedo-V2-0.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>又其实，这篇日志又是老早就准备更新了，因为各种原因，一直拖到现在，下面说下这次的主要更新：</p>
<ol>
<li>修正所有已知BUG  </li><li>重构了1.0的页面结构，对于自适应和页面布局方面完全取消对图片的依赖  </li><li>重设了背景区域和正文区域的背景，更加突出阅读重点  </li><li>重写了文章评论/回复部分，修复了原有的各种BUG，更加给力了回复功能和表情插入  </li><li>重写了页面的所有脚本逻辑交互，完全取消了对ZBLOG的common.js的依赖  </li><li>将所有非插件插入脚本全部移入文档底部，加速页面渲染（对速度有要求的朋友应该比较喜欢）  </li><li>对主题资源进行整合，在没有插件情况下首页只有6个外部资源请求（CSS<em>1+JS</em>2+IMG*3）</li>
</ol>
<p>总之，Ceedo 2.0 给你一个干净，简洁，够快的ZBLOG主题。</p>
<p>OK，感觉有点废话了，下面给出下载地址： <a href="http://www.laoshu133.cn/dl/#Ceedo" target="_blank" rel="external">Ceedo 2.0</a></p>
<p>另外，给希望在文章中插入代码而且需要高亮的朋友一个漂亮的代码高亮插件 <a href="http://www.laoshu133.cn/post/DsLighter.html" target="_blank" rel="external">DsLight</a></p>
<p>最后，欢迎<a href="http://www.laoshu133.cn/guestbook.asp" target="_blank" rel="external">各种板砖，各种建议</a></p>
<p>&nbsp; </p><p>—————————–华丽的分割线（v1.0）———————————-&nbsp; </p><p>其实早就准备写这篇文章了，只是空间不怎么给力，更不幸的是，在写这篇文章的时候自己一个不小心把电源给踩掉了-_-|||，结果又写第二遍…，主题是两周以前开始写的，到今天为止也算是正式发布了。  </p><p><img src="/themes/Ceedo/screenshot.png" alt="">这次主题总的来说我自己还是很满意的，虽然期间也遇到不少问题，但总算还是站着走过来了，其中自认为不错也是比较喜欢的几个效果，NAV导航，页面顶部底部导航，以及<a href="http://10.138.0.62/zblog/tags.asp" target="_blank" rel="external">TAGS页面</a>的效果，详细的自己看看小站就晓得啦，至于那版权什么的，有问题就直接找我吧，以下说下主题的特点</p>
<ol>
<li>整站自适应布局，仿两列等高，是一款很耐看，很实在的主题  </li><li>完全断开了很多主题所需的原程序中的common.js，当然，为了兼容插件依然引入了JQuery，并且升级版本为1.3.2  </li><li>高度的兼容浏览器，在已测的范围内，基本上没区别的，细微的，在个人能力范围内在所难免  </li><li>页面动画效果简单实在，个人相当喜欢，不过这主要还是要归功于JQuery的功劳  </li><li>整个主题加起来181K，不到200K的体积我自己是相当满意的，而且还是内置了JQ1.3.2的</li>
</ol>
<p>看完如果发现有喜欢可以<a href="mailto:laoshu133@vip.qq.com?subject=%E6%88%91%E8%A6%81%E4%B8%BB%E9%A2%98Ceedo" target="_blank" rel="external">猛击此处</a>找我要，本来是很想直接挂下载链接的，但是空间真的很不给力啊，说完优点，缺点肯定也是有的，说下在制作过程的比较纠结的一个问题，其实一开始我就是想好要“自适应两列等高布局”，在实际中也一直是按照这个宗旨前进着，在前期做自适应的时候还是很顺手的，因为网站布局只有两列，我一开始就用用的，<a href="http://10.138.0.62/zblog/view.asp?id=2" title="详情见我以前写的一篇小关于自适应的文章" target="_blank" rel="external">左列固定自适应</a>，右列绝对的定位的方式布局，在自适应上面下过相当不错了，不过也很快就发现问题了，因为右列用的是绝对定位，已经脱离了文档流，当右列高度大于左列的时候，会出现右列盖住底部的情况，不过这个问题如果pass掉IE6的话，也很好解决，加个min-height就搞定，而且还需要实现两列等高，实现两列等高自然还是采用相当经典的“padding-bottom - margin-bottom法”，这样只要再让主体容器overflow:hidden;就可以很简单的实现两列等高了，个人觉得边框模拟，多层嵌套什么的都是不实用的。</p>
<p>很不幸，现实总是和我们预想的是有那么点点区别的，很快BUG就出现了，先不说它不兼容IE6，更严重的是，我后来做文章显示页面，因为有评论，所以需要很多锚点，或者ID来导航、或者定位什么的，然后在定位评论框的时候，出现了在主体容器里面只剩下评论框的情况（本来很想上传图片的，空间忒不给力……），记得早些时候看过一篇关于“不要使用overflow:hidden清除浮动，overflow:hidden会元素在FF下获得焦点”，因为我测试也正好也是FF，以为是单例，结果一测发现在所有浏览器都表现的那么从来没有过的一致啊，我当时那个-_-|||，后来一想，其实这样是正常现象，overflow:hidden只是让容器不显示滚动条而已，当容器里的内容需要滚动的时候依然还是滚动的，只是溢出的部分隐藏了。</p>
<p>至此，上面的方法是不行了，然后在想了一个上午后，忽然想起以前岁月飞歌写过一篇文章，他说继上次“圣杯布局”以来，我们又迎来了“负来负去”布局的时代，我觉得这个确实也还是蛮有道理的，继续我们作为IT业中还算比较潮的一行，自然也需要试试“负来负去”的感觉，为了让左列自适应，不得不还给左列加上一层标签包裹起来，这次让左右两列都左浮动，然后左列宽度100%，左边负边距右列宽度，为了解决IE6的“下沉”现象，还得加上overflow-x:hidden，再然后让左列包裹层，左边正边距右列宽度就达到自适应的目的了，具体看代码吧<br><code>css.content, .slider{ float:left;} .content{ margin-left:-290px; overflow-x:hidden; width:100%;} .main{ margin-left:290px;}</code></p>
<p>然后实现自适应了，前面已经说了，“padding-bottom - margin-bottom法”是有BUG的了，肯定也是不行的了，多层嵌套什么的，也不是很喜欢，太浪费标签了，那么就背景模拟吧，因为前面右列用的绝对定位，所以主题容器上面加了position:relative，结果因为这个又杯具了，在除了IE6的浏览器下面都正常，但就是在IE6下面主题容器的背景硬就是不跟着浏览器的大小走（真的很想上图片的），还得我又调试了一上午才找到问题所在，最后我又特意去翻了一遍关于W3C对position:relative的解释：</p>
<blockquote>
<p>相对定位的元素框会偏移某个距离。元素仍然保持其未定位前的形状，它原本所占的空间仍保留”</p>
</blockquote>
<p>结果看来IE6还真是相当遵从它的“规定”啊，一点不让地方减少啊，整个容器的内容都在随着窗口的缩小而缩小，可是容器背景的位置就是不变，然后把position:relative去掉就解决问题了。</p>
<p>最后说下，可能有些时候在两列都左浮动的时候可能会产生IE6 3px bug，其实只要做到让左列右边和右列的左边没有外边距，基本上就木有问题了，还有当浏览器窗口相当小于一定大小后IE6会出现右列下沉的现象，其实解决也很简单，只要让左边容器overflow-x:hidden或者word-break:break-all，也就基本解决问题了。  </p><p>以上如有错误之处还望指正，如果您看完了此文，那么我是相当感激您的，对于我这么一个文笔相当差人来说，这已经是对我最大的尊敬了。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2011/10/28/在线五子棋对战.html" itemprop="url">
                  在线五子棋对战
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2011-10-28T16:27:45+08:00" content="2011-10-28">
              2011-10-28
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2011/10/28/在线五子棋对战.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/10/28/在线五子棋对战.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="/five/">在线五子棋对战</a>终于倒腾出来了 ^_^</p>
<p>在经过了长达半个月窝在屋里的时间终于让我折腾出了一点点值得欣慰的东西，总的来说自己还算满意，基本能做到不需要用户手册就能开玩。</p>
<p><a href="/five/">在线五子棋对战</a></p>
<p><a href="http://www.laoshu133.cn/five/" target="_blank" rel="external">http://five.laoshu133.com</a></p>
<p><a href="mailto:laoshu133@vip.qq.com" target="_blank" rel="external">联系我</a>&nbsp;<a href="/guestbook.asp?act=report&amp;type=bug">BUG反馈</a></p>
<p>目前五子棋支持3种模式，显示棋谱、双手互搏、在线对战，至于人机对战，因为能力有限，没研究多少人工智能，尚不支持。</p>
<p>显示棋谱：<a href="/five/?map=IFJEKELEMFMGMHLIKJJKILHMGLFKEJDICHCGCFDEEEFEGFHG&amp;delay=420" title="画心棋谱">画心演示</a></p>
<p>然后两个模式就可以在<a href="http://www.laoshu133.cn/five/" target="_blank" rel="external">http://five.laoshu133.com</a>自动切换了</p>
<p>主要说下，对战模式的实现</p>
<ol>
<li>对战模式采用的是AJAX轮询的方式实现的，所以延迟也必然是有的，后端是ASP写的，所以 长连接 也估计只能说浮云了</li>
<li>只是实现了简单的对战，前端，后端都没有做安全处理，所以外挂什么的是很容易的，路过请轻拍</li>
<li>如果你有兴趣看看后端数据模式，可以在对战下按下F12键，切换到网络模式，可以查看每次返回的数据，所有当前的对战信息在<a href="/five/five.asp?act=debug">这里</a>能看到</li>
</ol>
<p>然后，就是如果您觉得这个还算看得过去，请转发 <a href="http://www.laoshu133.cn/five/" target="_blank" rel="external">http://five.laoshu133.com</a></p>
<p>求广告，求推广</p>
<p>求BUG，求反馈</p>
<p>求板砖，还请轻拍<br>&lt;!–</p>
<p>最后，由于本人当前失业中，求<a href="/133.doc">被面</a><br>–&gt;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2011/10/21/浅谈javascript-与-flash通信.html" itemprop="url">
                  浅谈javascript 与 flash通信
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2011-10-21T09:51:46+08:00" content="2011-10-21">
              2011-10-21
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2011/10/21/浅谈javascript-与-flash通信.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/10/21/浅谈javascript-与-flash通信.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近在弄一个小游戏，玩游戏总要有点声音的，然后选择了用Flash出声，在做JS与Flash通信的时候，又一次被externalInterface.addCallback 和 embed 标签坑了，详情如下：</p>
<p>Flash设计的是 5 帧， 后面4帧每帧一个声音，然后用脚本控制播放，在最开始的时候，JS调用Flash原生的Play()方法，在各个浏览器下面都表现相当不错，接着使用如下AS脚本为JS添加回调，<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入包</span></span><br><span class="line"><span class="keyword">import</span> flash.external.*;</span><br><span class="line"><span class="comment">//允许哪些域访问</span></span><br><span class="line">system.Security.allowDomain(<span class="string">"*"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span></span><br><span class="line"><span class="comment">//提供JS访问的函数名</span></span><br><span class="line">methodName:<span class="built_in">String</span> = <span class="string">"playSound"</span>,</span><br><span class="line"><span class="comment">//指定本地函数中this变量的作用域，可设置为null留空</span></span><br><span class="line">self:<span class="built_in">Object</span> = <span class="keyword">this</span>,</span><br><span class="line"><span class="comment">//AS内部函数名</span></span><br><span class="line">soundMap = &#123;</span><br><span class="line">	down : <span class="number">2</span>,</span><br><span class="line">	win : <span class="number">3</span>,</span><br><span class="line">	draw : <span class="number">4</span>,</span><br><span class="line">	lose : <span class="number">5</span></span><br><span class="line">&#125;,</span><br><span class="line">playSound:<span class="built_in">Function</span> = <span class="function"><span class="keyword">function</span>(<span class="params">type</span>)</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(!!soundMap[type])&#123;</span><br><span class="line">		<span class="keyword">this</span>.gotoAndStop(soundMap[type]);</span><br><span class="line">		<span class="keyword">this</span>.gotoAndStop(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">//将函数注册到容器列表</span></span><br><span class="line"><span class="comment">//这里需要检测是否注册成功，因为如果是从缓存读取的，不一定是在flash完全load之后才执行此处</span></span><br><span class="line">regRet:<span class="built_in">Boolean</span> = <span class="literal">false</span>,</span><br><span class="line">regFn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	regRet = ExternalInterface.addCallback(methodName, self, playSound);</span><br><span class="line">	<span class="keyword">if</span>(regRet)&#123;</span><br><span class="line">		<span class="keyword">return</span> regRet;	<span class="comment">//注册成功</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//注册失败，重新注册</span></span><br><span class="line">	setTimeout(regFn, <span class="number">500</span>);</span><br><span class="line">&#125;;</span><br><span class="line">regFn();</span><br></pre></td></tr></table></figure></p>
<p>这里我还特意规避了一个以前弄一个<a href="/Lab/tester/">JS剪贴板</a>时遇到的一个问题，如果Flash是从缓存加载，有可能在调用ExternalInterface.addCallback()时，Flash还未加载完成，造成接口注册失败的问题，然而不幸的事情依旧还是发生了，此方法在IE下面表现良好，但是到了FF等下面，Flash依旧不来米，然后又经过了N个小时排查，总算找到了问题所在，又是因为IE和别的浏览器显示Flash用的模式不一致，我在调用Flash的时候一般用的自己写的一个<a href="/ds/flash.js">小JS库</a>，输出Flash，在做输出HTML的时候，默认参数是设置Flash的 <code>wmode=&quot;transparent&quot;</code>，因为这样能避免DIV盖不住Flash之类的问题，结果没想到这样居然也会让Flash接口失效.</p>
<p></p><p>最后这里的解决办法自然也就了然了，设置 <code>wmode=&quot;window&quot;</code>，顺利解决问题，仅此小记一笔。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2011/09/08/ZBLOG代码高亮插件-DsLighter.html" itemprop="url">
                  ZBLOG代码高亮插件 DsLighter
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2011-09-08T10:38:49+08:00" content="2011-09-08">
              2011-09-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2011/09/08/ZBLOG代码高亮插件-DsLighter.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2011/09/08/ZBLOG代码高亮插件-DsLighter.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>因为自己也经常也在BLOG上面贴点小代码，没有代码高亮感觉看着很不舒服，在菠萝格上面转了一圈，好不容易找到一个能用的，还发现效果很不满意，于是乎，就只好自己动手了，昨天在无意间在Node.js 逛的时候，发现他的代码高亮的效果感觉很不错，又于是乎，就给顺手牵过来了，此次代码高亮插件由 <a href="http://shjs.sourceforge.net/" target="_blank" rel="external">SHJS</a> 驱动。</p>
<p>效果请见（JS） ：<a href="http://www.laoshu133.cn/post/browser.html" target="_blank" rel="external">http://www.laoshu133.cn/post/browser.html</a></p>
<p>CSS 效果 ：<br><code>css table { border-collapse: collapse; border-spacing: 0; } h2 { font-size:16px; } hr { height:1px; border:none; border-top:1px dashed #ccc; margin:0; } .left { float:left; } .right { float:right; } .clr { clear:both; }</code></p>
<p>如有需要，请狂点 <a href="http://www.laoshu133.cn/dl/#DsLighter" target="_blank" rel="external">此处下载</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">23</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/laoshu133" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">米空格</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'laoshu133';
      var disqus_identifier = 'page/2/index.html';
      var disqus_title = "";
      var disqus_url = '';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
    </script>
  




  
  
  

  

  

</body>
</html>
